<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SINAB Is Not a Browser • sinab</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="SINAB Is Not a Browser">
<meta property="og:description" content="Provides support for rendering a small subset of static HTML and CSS to an
    R graphics device. Conversion from Markdown to HTML is also supported. The rendering
    library is entirely written in Rust, and it is built on top of the experimental project
    Victor by Simon Sapin.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">sinab</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/supported_CSS.html">Supported CSS properties</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="sinab-is-not-a-browser" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#sinab-is-not-a-browser" class="anchor"></a>Sinab is not a browser</h1></div>
<p>A basic html rendering engine for R, written in Rust. The purpose is not to write a browser, but rather to provide the ability to render simple, static html documents to an R graphics device.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>This package needs to be compiled from source and requires a working Rust toolchain (i.e., <a href="https://doc.rust-lang.org/cargo/getting-started/installation.html">Cargo</a>). If you have Cargo up and running, the following should work to install this package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"clauswilke/sinab"</span>)</span></code></pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>This project is in the early proof-of-concept stage. Expect most things to be broken.</p>
<p>The main function provided by this package is <code><a href="reference/html_grob.html">html_grob()</a></code>, which takes as input some Markdown or HTML text and associated CSS and renders it using the grid graphics system. The convenience function <code><a href="reference/html_grob.html">draw_html()</a></code> uses <code><a href="reference/html_grob.html">html_grob()</a></code> to generate the grob and then draws it with <code><a href="https://rdrr.io/r/grid/grid.draw.html">grid::grid.draw()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">library</span>(sinab)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">library</span>(grid)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a>mdtext &lt;-<span class="st"> "</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="st">Here are a few examples of word-wrapped and non-word-wrapped text. First</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span class="st">regular text pre-formatted:</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a><span class="st">&lt;pre&gt;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="st">The quick brown</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a><span class="st">  fox jumps over</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a><span class="st">    the lazy dog.</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a><span class="st">&lt;/pre&gt;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a><span class="st">Now some inline code: `x &lt;- 10; y &lt;- 200; z &lt;- 2*x + y;`</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a><span class="st">It gets wrapped.</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a><span class="st">We can also write block code. Notice how the long comment runs beyond</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a><span class="st">the box limits:</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a><span class="st">    x &lt;- 10</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a><span class="st">    y &lt;- 200</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a><span class="st">    z &lt;- 2*x + y;  # and a really really long comment</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true"></a><span class="st">"</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true"></a>css &lt;-<span class="st"> '</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true"></a><span class="st">pre { background-color: #eee;</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true"></a><span class="st">      padding: 6px;</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true"></a><span class="st">      border-left: 5px solid #888; }</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true"></a><span class="st">p   { background-color: #def;</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true"></a><span class="st">      margin: 16px 0px 4px 0px;</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true"></a><span class="st">      padding: 4px; }</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true"></a><span class="st">code { border: 1px solid #aaa; </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true"></a><span class="st">       padding: 2px; }</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true"></a><span class="st">pre code { border: none;</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true"></a><span class="st">           padding: 0px; }</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true"></a><span class="st">'</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true"></a><span class="co"># can also use `html_grob()` to obtain a grid grob for later drawing</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true"></a><span class="kw">draw_html</span>(</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true"></a>  mdtext, <span class="dt">css =</span> css,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true"></a>  <span class="dt">x =</span> <span class="kw">unit</span>(<span class="fl">0.1</span>, <span class="st">"npc"</span>), <span class="dt">y =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">"npc"</span>), <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">"inches"</span>),</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true"></a>)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>If the grob width is specified as a relative unit, then the grob is reactive and reflows as the graphics window is resized. (Try this example interactively.)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">draw_html</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>  mdtext, <span class="dt">css =</span> css,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>  <span class="dt">x =</span> <span class="kw">unit</span>(<span class="fl">0.1</span>, <span class="st">"npc"</span>), <span class="dt">y =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">"npc"</span>), <span class="dt">width =</span> <span class="kw">unit</span>(<span class="fl">0.8</span>, <span class="st">"npc"</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<p>Simple markdown-to-html conversion is also implemented:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">md_to_html</span>(<span class="st">"This is *a* **test**."</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="co">#&gt; [1] "&lt;p&gt;This is &lt;em&gt;a&lt;/em&gt; &lt;strong&gt;test&lt;/strong&gt;.&lt;/p&gt;\n"</span></span></code></pre></div>
</div>
<div id="faq" class="section level2">
<h2 class="hasAnchor">
<a href="#faq" class="anchor"></a>FAQ</h2>
<ul>
<li><p><strong>Why is HTML/CSS feature X, Y, or Z not available?</strong><br>
Rendering is done with a purpose-built layouting pipeline, and to date only a small subset of all possible features has been implemented.</p></li>
<li><p><strong>Will you support Javascript?</strong><br>
Probably not. The goal for Sinab is to render static pages. Interactivity doesn’t work well with R graphics devices.</p></li>
<li><p><strong>Is MathML supported?</strong><br>
Not at this time.</p></li>
<li><p><strong>Why is rendering so slow?</strong><br>
The Sinab library itself is actually quite fast. Slowness comes mostly from R graphics devices. In particular, text shaping can be extremely slow. For faster rendering, try one of the graphics devices provided by the ragg library, such as <code>agg_png()</code>. The following benchmark highlights the importance of the graphics device. The agg device is 250 times faster than the quartz device! All this extra time is spent text shaping.</p></li>
</ul>
<!-- --><div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>text &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">"Hello"</span>, <span class="dv">50</span>), <span class="dt">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>file &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">".png"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="kw">png</span>(file, <span class="dt">width =</span> <span class="dv">1920</span>, <span class="dt">height =</span> <span class="dv">1920</span>, <span class="dt">res =</span> <span class="dv">288</span>, <span class="dt">type =</span> <span class="st">"quartz"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(<span class="kw">render_markdown</span>(text), <span class="dt">times =</span> 10L)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="co">#&gt; Unit: milliseconds</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="co">#&gt;                   expr      min       lq     mean  median       uq    max neval</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="co">#&gt;  render_markdown(text) 714.2249 782.3504 1117.376 842.621 1119.572 2991.8    10</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a><span class="kw">invisible</span>(<span class="kw">dev.off</span>())</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a>ragg<span class="op">::</span><span class="kw">agg_png</span>(file, <span class="dt">width =</span> <span class="dv">1920</span>, <span class="dt">height =</span> <span class="dv">1920</span>, <span class="dt">res =</span> <span class="dv">288</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a>microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(<span class="kw">render_markdown</span>(text), <span class="dt">times =</span> 10L)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a><span class="co">#&gt; Unit: milliseconds</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a><span class="co">#&gt;                   expr      min       lq     mean  median       uq      max</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a><span class="co">#&gt;  render_markdown(text) 1.757393 1.965449 7.200562 2.12594 2.375721 53.15111</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a><span class="co">#&gt;  neval</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a><span class="co">#&gt;     10</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a><span class="kw">invisible</span>(<span class="kw">dev.off</span>())</span></code></pre></div>
<ul>
<li><p><strong>Why aren’t you supporting links (i.e., the <code>&lt;a&gt;</code> tag)?</strong><br>
This is a limitation of the current R graphics device API. There is simply no way to create a link in an R graphics device. Once this feature gets added, it will be easy to support it in Sinab.</p></li>
<li><p><strong>Why do my colors look wrong?</strong><br>
Sinab uses the color names defined by CSS, which in some cases are different from the color names that R uses. The most obvious example is probably “green”, which corresponds to #00ff00 in R but #008000 in CSS. If you want to be certain that you get the colors you want, specify them with hex codes in RGB format.</p></li>
</ul>
</div>
<div id="acknowledgments" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgments" class="anchor"></a>Acknowledgments</h2>
<p>The actual HTML/CSS parsing and rendering code is written in Rust, and it draws heavily from software developed for the Servo project. HTML parsing is done with <a href="https://github.com/servo/html5ever">html5ever</a>, CSS parsing is done with <a href="https://github.com/servo/rust-cssparser">cssparser</a>, and CSS selectors are implemented using the <a href="https://github.com/servo/servo/tree/master/components/selectors">selectors</a> crate. DOM, layout, and rendering is using custom code that is in no small part based on the experimental <a href="https://github.com/SimonSapin/victor">Victor</a> project written by Simon Sapin.</p>
<p>Markdown to HTML conversion is performed through the <a href="https://github.com/raphlinus/pulldown-cmark">pulldown-cmark</a> crate, which implements a lightweight Markdown parser that complies with the <a href="https://spec.commonmark.org/">CommonMark spec.</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Claus O. Wilke <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7470-9261" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Simon Sapin <br><small class="roles"> Author </small>  <br><small>(Author of the Victor project)</small>
</li>
<li>Anthony Ramine <br><small class="roles"> Author </small>  <br><small>(Contributor to the Victor project)</small>
</li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Claus O. Wilke, Simon Sapin, Anthony Ramine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
